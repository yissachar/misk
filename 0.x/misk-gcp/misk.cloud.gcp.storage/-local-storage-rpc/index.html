
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Misk: Microservice Container for Kotlin">
      
      
      
        <meta name="author" content="Square, Inc.">
      
      
      <link rel="icon" href="../../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.9">
    
    
      
        <title>LocalStorageRpc - Misk - Misk</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.f1a3b89f.min.css">
        
          
          
          <meta name="theme-color" content="#757575">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../css/app.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="grey" data-md-color-accent="green">
  
    
    <script>function __prefix(e){return new URL("../../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#localstoragerpc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../index.html" title="Misk" class="md-header__button md-logo" aria-label="Misk" data-md-component="logo">
      
  <img src="../../../../img/cashapp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Misk
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              LocalStorageRpc - Misk
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/cashapp/misk/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Misk
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../index.html" title="Misk" class="md-nav__button md-logo" aria-label="Misk" data-md-component="logo">
      
  <img src="../../../../img/cashapp.png" alt="logo">

    </a>
    Misk
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/cashapp/misk/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Misk
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../actions.html" class="md-nav__link">
        Actions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../clients.html" class="md-nav__link">
        Clients
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        0.x API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="0.x API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          0.x API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk/index.html" class="md-nav__link">
        misk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-aws/index.html" class="md-nav__link">
        misk-aws
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-aws-dynamodb/index.html" class="md-nav__link">
        misk-aws-dynamodb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-aws2-dynamodb/index.html" class="md-nav__link">
        misk-aws2-dynamodb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-crypto/index.html" class="md-nav__link">
        misk-crypto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-eventrouter/index.html" class="md-nav__link">
        misk-eventrouter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-events-core/index.html" class="md-nav__link">
        misk-events-core
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-events/index.html" class="md-nav__link">
        misk-events
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        misk-gcp
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-gcp-testing/index.html" class="md-nav__link">
        misk-gcp-testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-grpc-tests/index.html" class="md-nav__link">
        misk-grpc-tests
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-hibernate/index.html" class="md-nav__link">
        misk-hibernate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-hibernate-testing/index.html" class="md-nav__link">
        misk-hibernate-testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-inject/index.html" class="md-nav__link">
        misk-inject
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-jobqueue/index.html" class="md-nav__link">
        misk-jobqueue
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-jobqueue-testing/index.html" class="md-nav__link">
        misk-jobqueue-testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-metrics-digester/index.html" class="md-nav__link">
        misk-metrics-digester
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-prometheus/index.html" class="md-nav__link">
        misk-prometheus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-redis/index.html" class="md-nav__link">
        misk-redis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-testing/index.html" class="md-nav__link">
        misk-testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-zookeeper/index.html" class="md-nav__link">
        misk-zookeeper
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../misk-zoopkeeper-testing/index.md" class="md-nav__link">
        misk-zoopkeeper-testing
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../changelog.html" class="md-nav__link">
        Change Log
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../releasing.html" class="md-nav__link">
        Releasing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../releasing-manual.html" class="md-nav__link">
        Manual Releasing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing.html" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://stackoverflow.com/questions/tagged/misk?sort=active" class="md-nav__link">
        Stack Overflow ⏏
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#constructors" class="md-nav__link">
    Constructors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inherited-functions" class="md-nav__link">
    Inherited Functions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cashapp/misk/edit/master/docs/0.x/misk-gcp/misk.cloud.gcp.storage/-local-storage-rpc/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <p><a href="../../index.html">misk-gcp</a> / <a href="../index.html">misk.cloud.gcp.storage</a> / <a href="index.html">LocalStorageRpc</a></p>
<h1 id="localstoragerpc">LocalStorageRpc<a class="headerlink" href="#localstoragerpc" title="Permanent link">&para;</a></h1>
<p><code>class LocalStorageRpc :</code><a href="../-base-custom-storage-rpc/index.html"><code>BaseCustomStorageRpc</code></a></p>
<p>Implementation of <a href="#">StorageRpc</a> that is backed by local disk storage. Useful for running
in development mode on local machines, since there is no GCS emulator available. Files
are stored with the generation version appended as an extension suffix, with a symlink
existing for the latest generation. To preserve GCS atomicity semantics, progressive
uploads are handled by storing the interim uploaded data in a temporary file based
off the latest generation, then doing a rename to the new generation once the upload
is complete.</p>
<p>The implementation uses file locks to support multiple local processes accessing the same
storage directory. Whenever a blob is updated, the local store will acquire an exclusive
lock on a corresponding lock file, releasing that lock when the update is complete (or when
the process dies). It&rsquo;s slightly more complicated since we need to deal with the possibility
that writer stops partway through without the process failing; in those cases we don&rsquo;t want to
prevent subsequent updates from other processes.</p>
<p>Write process:</p>
<ul>
<li>on open</li>
<li>acquire a read lock</li>
<li>read metadata constraints, and create a new target metadata object for the next generation</li>
<li>release read lock</li>
<li>create a new temp file for receiving the update</li>
<li>generate an upload id, save the temp file location + target metadata + constraints
      in-memory associated with the upload id</li>
<li>on write</li>
<li>write to the temp file for that upload id</li>
<li>on finish</li>
<li>acquire a write lock, read the latest metadata for the blob and re-check constraints
      to make sure nothing changed underneath (e.g. a concurrent upload for that blob did
      not complete)</li>
<li>copy from the temp file to a new file in the content directory, appending the
      new generation number. This is done as an atomic move + overwrite</li>
<li>write updated metadata to the metadata file. This is done as an atomic move + overwrite.
      Until this is complete, the new version of the content is not accessible to readers.</li>
<li>release the write lock</li>
<li>remove the content file for the prior generation</li>
</ul>
<p>If a writer fails between open and finish, all that happens is we have abandoned temp files
If a writer fails after moving the temp file to the contents directory but before updating
    the metadata, then we have a bad content file for that generation sitting in the content
    directory. Since the metadata hasn&rsquo;t been updated with the new generation, this content
    is not readable, and a subsequent write will overwrite it.
If a writer fails after updating the metadata but before removing the prior generation
    content file, we&rsquo;ll have left an abandoned content file. A garbage collection process
    can be run to clean these up eventually</p>
<p>Read process</p>
<ul>
<li>acquire a read lock</li>
<li>read the metadata for the blob and check constraints (including etag)</li>
<li>read the raw bytes from the content file</li>
<li>release the read lock</li>
</ul>
<p>Clients use etags to detect when a blob is updated while a progressive download is in place; the
etag returned from a prior read is sent in subsequent reads. We simply use the generation number
as the etag value.</p>
<h3 id="constructors">Constructors<a class="headerlink" href="#constructors" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Summary</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="-init-.html">&lt;init&gt;</a></td>
<td><code>LocalStorageRpc(root:</code><a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html"><code>Path</code></a>`, moshi: Moshi = Moshi.Builder()</td>
</tr>
<tr>
<td>.add(KotlinJsonAdapterFactory()) // Added last for lowest precedence.</td>
<td></td>
</tr>
<tr>
<td>.build())`<br>Implementation of <a href="#">StorageRpc</a> that is backed by local disk storage. Useful for running in development mode on local machines, since there is no GCS emulator available. Files are stored with the generation version appended as an extension suffix, with a symlink existing for the latest generation. To preserve GCS atomicity semantics, progressive uploads are handled by storing the interim uploaded data in a temporary file based off the latest generation, then doing a rename to the new generation once the upload is complete.</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="functions">Functions<a class="headerlink" href="#functions" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Summary</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="create.html">create</a></td>
<td><code>fun create(obj: StorageObject, content:</code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html"><code>InputStream</code></a><code>, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): StorageObject?</code></td>
</tr>
<tr>
<td><a href="delete.html">delete</a></td>
<td><code>fun delete(obj: StorageObject, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><code>Boolean</code></a></td>
</tr>
<tr>
<td><a href="get.html">get</a></td>
<td><code>fun get(obj: StorageObject, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): StorageObject?</code></td>
</tr>
<tr>
<td><a href="list.html">list</a></td>
<td><code>fun list(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): Tuple&lt;</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>,</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-iterable/index.html"><code>Iterable</code></a><code>&lt;StorageObject&gt;&gt;</code></td>
</tr>
<tr>
<td><a href="load.html">load</a></td>
<td><code>fun load(obj: StorageObject, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-byte-array/index.html"><code>ByteArray</code></a></td>
</tr>
<tr>
<td><a href="open.html">open</a></td>
<td><code>fun open(obj: StorageObject, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a></td>
</tr>
<tr>
<td><a href="open-rewrite.html">openRewrite</a></td>
<td><code>fun openRewrite(request: RewriteRequest): RewriteResponse</code></td>
</tr>
<tr>
<td><a href="read.html">read</a></td>
<td><code>fun read(from: StorageObject, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;, zposition:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html"><code>Long</code></a><code>, outputStream:</code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/OutputStream.html"><code>OutputStream</code></a><code>):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html"><code>Long</code></a></td>
</tr>
<tr>
<td><a href="write.html">write</a></td>
<td><code>fun write(uploadId:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>, toWrite:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-byte-array/index.html"><code>ByteArray</code></a><code>, toWriteOffset:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><code>Int</code></a><code>, destOffset:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html"><code>Long</code></a><code>, length:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><code>Int</code></a><code>, last:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><code>Boolean</code></a><code>):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><code>Unit</code></a></td>
</tr>
</tbody>
</table>
<h3 id="inherited-functions">Inherited Functions<a class="headerlink" href="#inherited-functions" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Summary</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../-base-custom-storage-rpc/compose.html">compose</a></td>
<td><code>open fun compose(sources:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-iterable/index.html"><code>Iterable</code></a><code>&lt;StorageObject&gt;?, target: StorageObject?, targetOptions:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): StorageObject</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/continue-rewrite.html">continueRewrite</a></td>
<td><code>open fun continueRewrite(previousResponse: RewriteResponse): RewriteResponse</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/create.html">create</a></td>
<td><code>open fun create(bucket: Bucket, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): Bucket</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/create-acl.html">createAcl</a></td>
<td><code>open fun createAcl(acl: BucketAccessControl?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): BucketAccessControl</code><br><code>open fun createAcl(acl: ObjectAccessControl?): ObjectAccessControl</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/create-batch.html">createBatch</a></td>
<td><code>open fun createBatch(): RpcBatch</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/create-default-acl.html">createDefaultAcl</a></td>
<td><code>open fun createDefaultAcl(acl: ObjectAccessControl?): ObjectAccessControl</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/create-notification.html">createNotification</a></td>
<td><code>open fun createNotification(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, notification: Notification?): Notification</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/delete.html">delete</a></td>
<td><code>open fun delete(bucket: Bucket, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><code>Boolean</code></a></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/delete-acl.html">deleteAcl</a></td>
<td><code>open fun deleteAcl(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, entity:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><code>Boolean</code></a><br><code>open fun deleteAcl(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, object:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, generation:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html"><code>Long</code></a><code>?, entity:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><code>Boolean</code></a></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/delete-default-acl.html">deleteDefaultAcl</a></td>
<td><code>open fun deleteDefaultAcl(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, entity:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><code>Boolean</code></a></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/delete-notification.html">deleteNotification</a></td>
<td><code>open fun deleteNotification(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, notification:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><code>Boolean</code></a></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/get.html">get</a></td>
<td><code>open fun get(bucket: Bucket, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): Bucket?</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/get-acl.html">getAcl</a></td>
<td><code>open fun getAcl(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, entity:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): BucketAccessControl</code><br><code>open fun getAcl(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, obj:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, generation:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html"><code>Long</code></a><code>?, entity:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?): ObjectAccessControl</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/get-default-acl.html">getDefaultAcl</a></td>
<td><code>open fun getDefaultAcl(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, entity:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?): ObjectAccessControl</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/get-iam-policy.html">getIamPolicy</a></td>
<td><code>open fun getIamPolicy(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): Policy</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/get-service-account.html">getServiceAccount</a></td>
<td><code>open fun getServiceAccount(projectId:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?): ServiceAccount</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/list.html">list</a></td>
<td><code>open fun list(options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): Tuple&lt;</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>,</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-iterable/index.html"><code>Iterable</code></a><code>&lt;Bucket&gt;&gt;</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/list-acls.html">listAcls</a></td>
<td><code>open fun listAcls(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><code>List</code></a><code>&lt;BucketAccessControl&gt;</code><br><code>open fun listAcls(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, obj:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, generation:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html"><code>Long</code></a><code>?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><code>List</code></a><code>&lt;ObjectAccessControl&gt;</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/list-default-acls.html">listDefaultAcls</a></td>
<td><code>open fun listDefaultAcls(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-mutable-list/index.html"><code>MutableList</code></a><code>&lt;ObjectAccessControl&gt;</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/list-notifications.html">listNotifications</a></td>
<td><code>open fun listNotifications(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><code>List</code></a><code>&lt;Notification&gt;</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/lock-retention-policy.html">lockRetentionPolicy</a></td>
<td><code>open fun lockRetentionPolicy(bucket: Bucket?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): Bucket</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/open.html">open</a></td>
<td><code>open fun open(signedURL:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?):</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/patch.html">patch</a></td>
<td><code>open fun patch(bucket: Bucket, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): Bucket?</code><br><code>open fun patch(obj: StorageObject, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): StorageObject?</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/patch-acl.html">patchAcl</a></td>
<td><code>open fun patchAcl(acl: BucketAccessControl?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): BucketAccessControl</code><br><code>open fun patchAcl(acl: ObjectAccessControl?): ObjectAccessControl</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/patch-default-acl.html">patchDefaultAcl</a></td>
<td><code>open fun patchDefaultAcl(acl: ObjectAccessControl?): ObjectAccessControl</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/read.html">read</a></td>
<td><code>open fun read(from: StorageObject?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?, position:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html"><code>Long</code></a><code>, bytes:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><code>Int</code></a><code>): Tuple&lt;</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>,</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-byte-array/index.html"><code>ByteArray</code></a><code>&gt;</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/set-iam-policy.html">setIamPolicy</a></td>
<td><code>open fun setIamPolicy(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>?, policy: Policy?, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;?): Policy</code></td>
</tr>
<tr>
<td><a href="../-base-custom-storage-rpc/test-iam-permissions.html">testIamPermissions</a></td>
<td><code>open fun testIamPermissions(bucket:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>, permissions:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><code>List</code></a><code>&lt;</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><code>String</code></a><code>&gt;, options:</code><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html"><code>Map</code></a><code>&lt;Option, *&gt;): TestIamPermissionsResponse</code></td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018-2021 Square, Inc.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.82b56eb2.min.js"></script>
      
    
  </body>
</html>